% Logan Prust - Astro 344L - Lab 3 Data Analysis

clear,clc;
n=5;
p=8;
m(1,:)=[8.13015,8.11749,8.13089,7.77019,8.14733];
m(2,:)=[9.07961,9.06607,9.02808,8.68940,9.07616];
m(3,:)=[8.10594,8.12721,8.09885,8.09443,8.09664];
m(4,:)=[8.91591,8.92010,8.90152,8.91422,8.96280];
m(5,:)=[8.80182,8.80773,8.73307,8.77290,8.73559];
m(6,:)=[9.68746,9.75618,9.70415,9.64291,9.60258];
m(7,:)=[8.69904,8.72091,8.74742,8.70010,8.72941];
m(8,:)=[9.51610,9.53167,9.52652,9.49274,9.49907];
sigma(1,:)=[0.0103582,0.0107748,0.0105165,0.0110736,0.0125349];
sigma(2,:)=[0.0201263,0.0209552,0.0198288,0.0208289,0.0243261];
sigma(3,:)=[0.00728852,0.00776356,0.00773829,0.00753025,0.00765391];
sigma(4,:)=[0.0135701,0.0127906,0.0131009,0.0125393,0.0130747];
sigma(5,:)=[0.0135701,0.0149027,0.0165614,0.0173460,0.0166764];
sigma(6,:)=[0.0259877,0.0307858,0.0349053,0.0334114,0.0329247];
sigma(7,:)=[0.0118803,0.0114029,0.0119603,0.0117282,0.0117908];
sigma(8,:)=[0.0211114,0.0207777,0.0213433,0.0210686,0.0206670];
for i=1:p
    for j=1:n
        Mnumerator(i,j)=m(i,j)/sigma(i,j)^2;
        Mdenominator(i,j)=1/sigma(i,j)^2;
    end
end
mfinal=sum(Mnumerator')./sum(Mdenominator');
for i=1:p
    for j=1:n
        msubt(i,j)=(m(i,j)-mfinal(i))^2;
    end
end
for i=1:p
    sigmafinal(i)=sqrt(1/(n-1)*sum(msubt(i,:)));
end
disp(mfinal');
disp(sigmafinal');